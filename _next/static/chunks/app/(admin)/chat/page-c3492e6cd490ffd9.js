(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7142],{1469:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var l in t)Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}(t,{default:function(){return c},getImageProps:function(){return i}});let r=l(8229),s=l(8883),a=l(3063),n=r._(l(1193));function i(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/yunce-nextjs-portal/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,l]of Object.entries(t))void 0===l&&delete t[e];return{props:t}}let c=a.Image},3968:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>i});var r=l(5155),s=l(2115),a=l(6766);let n="yunce_ai_chat_sessions_v1";function i(){var e;let t="/yunce-nextjs-portal",l=e=>e.startsWith("http")||t&&e.startsWith(t+"/")?e:"".concat(t).concat(e.startsWith("/")?"":"/").concat(e),[i,c]=(0,s.useState)([]),[o,d]=(0,s.useState)(""),u=(0,s.useMemo)(()=>{var e;return null!==(e=i.find(e=>e.id===o))&&void 0!==e?e:null},[i,o]),f=null!==(e=null==u?void 0:u.messages)&&void 0!==e?e:[],[m,g]=(0,s.useState)(""),h=(0,s.useRef)(null),b=(0,s.useMemo)(()=>l("/images/user/user-02.jpg"),[t]),x=(0,s.useMemo)(()=>l("/images/logo/logo-icon.svg"),[t]),p=()=>{var e;let t=m.trim();if(!t||!u)return;let l={id:"m-".concat(Date.now()),role:"user",text:t,tone:"primary"};c(e=>e.map(e=>e.id===o?{...e,title:0===e.messages.length?t.slice(0,20):e.title,messages:[...e.messages,l]}:e)),g(""),setTimeout(()=>{var e;c(e=>e.map(e=>e.id===o?{...e,messages:[...e.messages,{id:"m-".concat(Date.now(),"-ai"),role:"assistant",text:"这是示例回复：我已收到您的问题，稍后给出详细分析。",tone:"neutral"}]}:e)),null===(e=h.current)||void 0===e||e.scrollTo({top:h.current.scrollHeight,behavior:"smooth"})},500),null===(e=h.current)||void 0===e||e.scrollTo({top:h.current.scrollHeight,behavior:"smooth"})};s.useEffect(()=>{try{let e=localStorage.getItem(n);if(e){let t=JSON.parse(e);c(t),t.length>0&&d(t[0].id)}else{let e={id:"s-".concat(Date.now()),title:"新的对话",createdAt:Date.now(),messages:[{id:"m-".concat(Date.now()),role:"assistant",text:"您好，我是云策AI助手。有什么可以帮您？",tone:"info"}]};c([e]),d(e.id)}}catch(e){}},[]),s.useEffect(()=>{try{localStorage.setItem(n,JSON.stringify(i))}catch(e){}},[i]);let v=e=>{if(c(t=>t.filter(t=>t.id!==e)),o===e){var t,l;d(null!==(l=null===(t=i.filter(t=>t.id!==e)[0])||void 0===t?void 0:t.id)&&void 0!==l?l:"")}},j=(e,t)=>{c(l=>l.map(l=>l.id===e?{...l,title:t}:l))};return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 sm:gap-6 h-[calc(100vh-2rem)]",children:[(0,r.jsxs)("aside",{className:"lg:col-span-3 rounded-2xl border border-gray-200 p-3 dark:border-gray-800 bg-white dark:bg-white/[0.03] flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"会话"}),(0,r.jsx)("button",{className:"btn btn-sm",onClick:()=>{let e={id:"s-".concat(Date.now()),title:"新的对话",createdAt:Date.now(),messages:[]};c(t=>[e,...t]),d(e.id)},children:"新建"})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:(0,r.jsx)("ul",{className:"menu bg-transparent w-full",children:i.map(e=>(0,r.jsxs)("li",{children:[(0,r.jsx)("a",{className:"rounded-lg ".concat(e.id===o?"active bg-base-200":""),onClick:()=>d(e.id),children:(0,r.jsx)("span",{className:"truncate",children:e.title||"未命名会话"})}),e.id===o&&(0,r.jsxs)("div",{className:"flex items-center gap-2 px-2 py-2",children:[(0,r.jsx)("input",{className:"input input-bordered input-sm w-full",defaultValue:e.title,onBlur:t=>j(e.id,t.target.value.trim()||"未命名会话")}),(0,r.jsx)("button",{className:"btn btn-sm",onClick:()=>v(e.id),children:"删除"})]})]},e.id))})})]}),(0,r.jsxs)("section",{className:"lg:col-span-9 flex flex-col",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,r.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 dark:text-white",children:"大模型对话"})}),(0,r.jsx)("div",{ref:h,className:"flex-1 overflow-y-auto rounded-2xl border border-gray-200 p-4 dark:border-gray-800 bg-white dark:bg-white/[0.03]",children:(0,r.jsx)("div",{className:"space-y-4",children:f.map(e=>{let t="user"===e.role,l=e.tone?"chat-bubble-".concat(e.tone):"";return(0,r.jsxs)("div",{className:"chat ".concat(t?"chat-end":"chat-start"),children:[(0,r.jsx)("div",{className:"chat-image avatar",children:(0,r.jsx)("div",{className:"w-10 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-800",children:(0,r.jsx)(a.default,{src:t?b:x,alt:t?"User":"AI",width:40,height:40})})}),(0,r.jsx)("div",{className:"chat-bubble ".concat(l),children:e.text})]},e.id)})})}),(0,r.jsx)("div",{className:"rounded-2xl border border-gray-200 p-3 mt-4 dark:border-gray-800 bg-white dark:bg-white/[0.03]",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{className:"input input-bordered w-full",placeholder:"输入消息，按 Enter 发送",value:m,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),p())}}),(0,r.jsx)("button",{className:"btn btn-primary",onClick:p,disabled:!u,children:"发送"})]})})]})]})}},6654:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return s}});let r=l(2115);function s(e,t){let l=(0,r.useRef)(null),s=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=l.current;e&&(l.current=null,e());let t=s.current;t&&(s.current=null,t())}else e&&(l.current=a(e,r)),t&&(s.current=a(t,r))},[e,t])}function a(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let l=e(t);return"function"==typeof l?l:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6766:(e,t,l)=>{"use strict";l.d(t,{default:()=>s.a});var r=l(1469),s=l.n(r)},7372:(e,t,l)=>{Promise.resolve().then(l.bind(l,3968))}},e=>{var t=t=>e(e.s=t);e.O(0,[3063,8441,1684,7358],()=>t(7372)),_N_E=e.O()}]);